# Project Implementation Plan: Local-First Job Tracker

**Branch**: `main` | **Date**: 2025-12-28 | **Owner**: rj4zz
**Status**: In Progress

---

## 1. Executive Summary
We are building a **local-first, privacy-focused Job Tracking Dashboard** hosted on Cloudflare Pages. The application will run entirely in the browser (Single Page Application) using IndexedDB for storage, ensuring zero latency and 100% data privacy. The primary goal is to replace spreadsheet tracking with a rich UI that stores job descriptions, statuses, and notes without requiring a backend server.

## 2. Technical Context & Constraints

| Parameter | Details |
|-----------|---------|
| **Language** | JavaScript (ES6+) + React 18+ |
| **Build Tool** | Vite (Fast builds, optimized for Cloudflare Pages) |
| **Storage** | **IndexedDB** (via **Dexie.js** wrapper) |
| **UI Framework** | **Shadcn UI** + Tailwind CSS (configured for JavaScript) |
| **Hosting** | Cloudflare Pages (Static Asset Serving) |
| **Constraints** | **No Backend DB**. Data lives on the user's device. "Nuclear" data loss risk if browser cache is cleared, requiring a robust Import/Export feature. |

## 3. Specifications & Requirements

### User Stories (Prioritized)

#### Story 1: Core Tracking (Priority: P1 - MVP)
*   **Description**: As a job seeker, I want to save a job posting with its details so I can track my application progress.
*   **Why**: To replace messy spreadsheets with a dedicated interface.
*   **Acceptance Criteria**:
    1. **Given** the "Add Job" form, **When** I enter Company, Role, and Description, **Then** the job appears in my "Applied" list immediately.
    2. **Given** a saved job, **When** I click "Delete", **Then** it is permanently removed from the local database.

#### Story 2: Data Backup (Priority: P1 - Critical)
*   **Description**: As a user, I want to download my data as a file and restore it later.
*   **Why**: Since data is local-only, clearing browser history deletes everything. I need a way to save/move my data.
*   **Acceptance Criteria**:
    1. **Given** I have tracked jobs, **When** I click "Export Data", **Then** a `jobs_backup_[date].json` file downloads.
    2. **Given** a new browser session, **When** I upload that JSON file, **Then** all my previous job entries are restored.

### Functional Requirements
*   **FR-001**: System MUST store at least 5MB of text data (Job Descriptions) without performance degradation.
*   **FR-002**: System MUST load the dashboard in < 1 second (perceived performance).

## 4. Architecture & Data Model

### Data Model (Dexie Schema)
**Table:** `jobs`
```javascript
{
  id: Number,           // UUID based Primary Key
  company: String,      // Indexable
  position: String,
  status: String,       // 'applied' | 'interviewing' | 'offer' | 'rejected'
  description: String,  // Large text blob
  url: String,
  salary: String,
  dateAdded: Number,    // Date.now()
  lastUpdated: Number
}
```

### Directory Structure
```text
src/
├── App.css
├── App.jsx
├── components/                     # Reusable components 
│   ├── common
│   │   └── SortableTableHead.jsx
│   ├── data/                       # Components for data management (Import/Export)
│   │   └── DataControls.jsx
│   ├── jobs                        # Job Tracking Components
│   │   ├── JobForm.jsx
│   │   ├── JobFormPanel.jsx
│   │   ├── JobRow.jsx
│   │   └── JobTable.jsx
│   └── ui/                         # Shadcn Components
├── index.css
├── lib/
│   ├── db.js
│   └── utils.js
└── main.jsx
```

### Component Hierarchy and Prop Flow
```mermaid
graph TD
    %% Global Level
    subgraph Root [src/]
        App[App.jsx]
    end

    %% Jobs Components
    subgraph Jobs_Dir [src/components/jobs/]
        JFP[JobFormPanel]
        JF[JobForm]
        JT[JobTable]
        JR[JobRow]
    end

    %% Data Components
    subgraph Data_Dir [src/components/data/]
        DC[DataControls]
    end

    %% Common Components
    subgraph Common_Dir [src/components/common/]
        STH[SortableTableHead]
    end

    %% Storage Layer
    subgraph Storage [src/lib/]
        DB[(db.js IndexedDB)]
    end

    %% Hierarchy and Prop Flow
    App --> JFP
    App --> DC
    App --> JT

    JFP -- "props: onSubmit" --> JF
    JT -- "props: sortConfig, requestSort" --> STH
    JT -- "props: job (object)" --> JR

    %% Data Flow (Reactive/Direct)
    JF -. "writes" .-> DB
    JT -. "live query" .-> DB
    DC -. "bulk/export" .-> DB
    JR -. "delete" .-> DB

    %% Styling
    style DB fill:#301934,stroke:#333,stroke-width:2px
    style App fill:#301934,stroke:#333,stroke-width:2px
```

## 5. Implementation Tasks

**Legend**: `[P]` Parallelizable | `[US#]` User Story | `[ ]` To Do

### Phase 1: Setup & Configuration
*Foundational work.*

- [x] **T001**: Initialize Vite React project (`npm create vite@latest . -- --template react`)
- [x] **T002**: Install Tailwind CSS & PostCSS
- [x] **T003**: Configure `jsconfig.json` for path aliases (`@/*` -> `./src/*`)
- [x] **T004**: Initialize Shadcn UI (`npx shadcn@latest init`). **Important:** Select "TypeScript: No" during setup.

### Phase 2: Core Foundation & Database
*The backend-in-the-frontend.*

- [x] **T005**: Install Dexie (`npm install dexie dexie-react-hooks`)
- [x] **T006**: Create `src/lib/db.js` and define the schema: `.stores({ jobs: '++id, company, status, dateAdded' })`
- [x] **T007**: [P] Install necessary Shadcn components.

### Phase 3: User Story 1 (Add/List/Delete)
*The MVP.*

- [x] **T008**: [US1] Create `JobForm.jsx` with state handling for Company, Role, Status.
- [x] **T009**: [US1] Connect Form to Dexie: `db.jobs.add({...})`.
- [x] **T010**: [US1] Create `JobTable.jsx` using `useLiveQuery` hook to fetch data.
- [x] **T011**: [US1] Implement Delete and sorting functionality in the table view.
- [x] **T012**: [US1] [P] Implement success feedback (e.g., toast message) upon job submission.

### Phase 4: User Story 2 (Data Backup)
*Critical Safety Feature.*

- [x] **T013**: [US2] Create `DataControls.jsx`.
- [x] **T014**: [US2] Implement Export.
- [x] **T015**: [US2] Implement Import.

### Phase 5: Deployment & Polish
- [x] **T016**: [US1] Move the `JobForm` to a shadcn `Sheet` component on the right
- [ ] **T017**: [US1] Show a dropdown menu for sorting and hiding when clicking the column head.
- [ ] **T018**: Create Cloudflare Pages project and connect to GitHub repo.
- [ ] **T019**: Verify Build Command: `npm run build` and Output Dir: `dist`.

## 6. Notes & Decisions

*   **2025-12-28**: Chosen **Dexie.js** over `localStorage` because Job Descriptions can be large, and we need efficient indexing/sorting which LocalStorage cannot provide.
*   **2025-12-28**: Chosen **Shadcn UI** even though we are using JavaScript. We will use the CLI to generate JS components or manually strip types if the CLI fails, as the visual quality saves significant CSS time.
*   **2025-12-28**: **Import/Export** is elevated to P1 because we cannot rely on browser persistence indefinitely.
* **2025-12-29**: Transitioned to **Tailwind CSS v4** for the project foundation, prioritizing modern "CSS-first" architecture over legacy v3 configuration.
    * **Vite**, by default, handles CSS minification using esbuild (or Lightning CSS in newer versions/configurations). **Tailwind CSS v4** integrates well with Vite's build process. When you execute npm run build, Vite will automatically minify and compress your CSS into a single, optimized file located in the dist/ folder.
* **2025-12-29**: Discovered that `npx tailwindcss init -p` is deprecated in v4; configuration is now handled via the `@tailwindcss/vite` plugin and direct `@theme` blocks in CSS.
* **2025-12-29**: Configured **Vite Path Aliases** using `path.resolve` in `vite.config.js` and also `jsconfig.json` to support the `@/` prefix required by Shadcn UI CLI for downloading components and for sane imports(@/folder instead of ../.. hell)
* **2025-12-29**: Resolved "Unknown at rule @theme" editor warnings by identifying it as a linting false-positive, solvable via the Tailwind CSS IntelliSense extension or CSS linting overrides.
* **2025-12-29**: Verified that **Shadcn UI CLI** (v3.6.2+) natively detects Tailwind v4 and successfully generates JavaScript (`.jsx`) components when TypeScript is absent.
* **2025-12-29**: Confirmed Tailwind v4 styling is active by testing modern utility classes (e.g., `shadow-md`, `active:scale-95`) and the new `@import "tailwindcss"` directive.
* **2025-12-29**: [US1] Installed and learned that Dexie's `.stores()` schema only requires **indexable** fields; additional data (like large descriptions) can be stored without being explicitly declared in the schema. So those are the columns for which the indexing engine generates indexes.
* **2025-12-29**: Successfully installed Shadcn UI components (`button`, `card`, `input`, `textarea`, `select`, `badge`) and confirmed they are available for use, adhering to the project's JavaScript-first approach.
* **2025-12-29**: [US1] Created `JobForm.jsx` and exported the component to App
    * *Named vs Default*: Only one default export allowed per file, more appropriate for exporting components or primary API in contrast to constants, or utility functions that are exported using named exports.
*   **2025-12-30**: [US1] Added `description` (with `Textarea` with longer text inputs), `url`, and `salary` fields (with their respective types) to the `JobForm` component's state and JSX, and updated the initial state in `JobForm.jsx` to include these new fields.
* **2025-12-31**: [US1] Added a confirmation dialog and toaster to the Delete functionality for better UX. Since the toaster had to be declared globally, I added it to `App.jsx`.
    * `App.jsx` serves as the root component where all other components and global contexts are nested.
    * `main.jsx` is primarily concerned with initialization—setting up the React root, potentially configuring global providers, and mounting the main App component to your HTML file's root element.
* **2025-01-01**: [US1] Decided to break down the JobTable component into many small components like `JobRow` and `SortableTableHead`
* **2025-01-01**: Used utility classes provided by Tailwind CSS for controlling the size of lucide icons representing sort up and sort down in Job Listing Table
* **2025-01-02**: [US2] Decided to use hidden file input for file upload and used React's `useRef` Hook.
    * `useRef` is a built-in React Hook that allows us to persist a value without triggering a re-render when its value changes(which happens synchronously). This allows us to use it for behind the scenes logic like file upload since it can persist the hidden link to `<Input>` tag and mimic a click on it when I invoke it through Import button. However, should always be used inside event handlers or `useEffect` hooks instead of being used for rendering components. It should be also be called only at the top level.
* **2025-01-02**: [US2] Used the modern Promise-based `file.text()` API with concise syntax for reading the uploaded data file.
    * `FileReader.readAsText()` allows progress tracking which isn't relevant here.
* **2025-01-02**: [US2] Reset the file upload input finally after handling fileUpload.
* **2025-01-02**: [US1] Switched to a UUID based primary key so as to make data transfer easier.
* **2025-01-02**: [US2] Used `Table.bulkPut` that upserts from backup.
* **2025-01-03**: [US1] Refactored `JobForm` to a side panel.
    * Passed the control of open state as a prop to the original form component, which is then called optionally, enabling its use in other contexts.
    * Also used `SheetContent`component's `onInteractOutside` prop to block any unforseen interaction from accidently closing the form.
* **2025-01-03**: [US2] Coded a cleaner way for doing zero index access of file list using *array destructuring*.
* **2025-01-03**: [T017] Defined column a configuration externally(outside the `JobTable` component) to enable future reusability, performant(loaded in2 module only once) and cleaner code(Config ⊥ Logic).
    * Used the reduce+spread operator to create an initial state object for the columns
* **2025-01-06**: [T017] Opted for a **Master "View" Button** in the toolbar rather than per-column dropdowns. This provides a centralized UX for managing the table layout without cluttering individual headers.
* **2025-01-06**: Switched to a *Feature Wrapper* (`JobDashboard`) to wrap around `JobTable` and Toolbar components. While **React Context** was an alternative, this pattern provides clearer data flow and better debuggability.
* **2025-01-06**: [T017] Established a **Centralized Column Configuration** in `constants.jsx`. This array is the single source of truth for labels, sorting keys, and dynamic rendering logic.